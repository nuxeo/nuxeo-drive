# 5.1.2

Release date: `2021-xx-xx`

## Core

- [NXDRIVE-826](https://jira.nuxeo.com/browse/NXDRIVE-826): Add OAuth2 capabilities
- [NXDRIVE-2371](https://jira.nuxeo.com/browse/NXDRIVE-2371): Secure storage of the token in the database
- [NXDRIVE-2581](https://jira.nuxeo.com/browse/NXDRIVE-2581): Add the synchronization feature
- [NXDRIVE-2606](https://jira.nuxeo.com/browse/NXDRIVE-2606): Catch `TypeError` in `RemoteFileInfo.from_dict()`
- [NXDRIVE-2607](https://jira.nuxeo.com/browse/NXDRIVE-2607): Handle invalid data returned by the server when asking for a `batchId`
- [NXDRIVE-2609](https://jira.nuxeo.com/browse/NXDRIVE-2609): Handle HTTP 504 errors (Gateway Time-out)
- [NXDRIVE-2610](https://jira.nuxeo.com/browse/NXDRIVE-2610): Remove the `TRACE` logging level, obsolete since 4.1.0
- [NXDRIVE-2617](https://jira.nuxeo.com/browse/NXDRIVE-2617): Move to `cryptography` module for cryptography stuff
- [NXDRIVE-2619](https://jira.nuxeo.com/browse/NXDRIVE-2619): Remove `Engine` databases on failed account addition
- [NXDRIVE-2620](https://jira.nuxeo.com/browse/NXDRIVE-2620): Ignore `RuntimeError: wrapped C/C++ object of type LinkingAction has been deleted` in `Action.finish()`

### Direct Edit

- [NXDRIVE-2608](https://jira.nuxeo.com/browse/NXDRIVE-2608): Handle HTTP 502 (Bad Gateway), 503 (Service Unavailable) and 504 (Gateway Time-out) errors
- [NXDRIVE-2621](https://jira.nuxeo.com/browse/NXDRIVE-2621): Handle HTTPError 404 (Not Found) errors

### Direct Transfer

- [NXDRIVE-2](https://jira.nuxeo.com/browse/NXDRIVE-2):

## GUI

- [NXDRIVE-2](https://jira.nuxeo.com/browse/NXDRIVE-2):

## Packaging / Build

- [NXDRIVE-2](https://jira.nuxeo.com/browse/NXDRIVE-2):

## Tests

- [NXDRIVE-2602](https://jira.nuxeo.com/browse/NXDRIVE-2602): Remove unnecessary Codecov token usage
- [NXDRIVE-2603](https://jira.nuxeo.com/browse/NXDRIVE-2603): Fix `test_flooding_prevention()` when run from `tox`
- [NXDRIVE-2605](https://jira.nuxeo.com/browse/NXDRIVE-2605): Declare early the `remote` attribute in `Engine`

## Docs

- [NXDRIVE-2](https://jira.nuxeo.com/browse/NXDRIVE-2):

## Minor Changes

- Added `authlib` 0.15.3
- Added `cryptography` 3.4.7
- Upgraded `docutils` from 0.17 to 0.17.1
- Upgraded `nuxeo` from 5.0.0 to 5.1.0
- Upgraded `pyinstaller` from 4.2 to 4.3
- Removed `pycryptodomex`

## Technical Changes

- Added `Application.synchronization_feature_model`
- Added `details` keyword argument to `Application.display_warning()`
- Updated `DirectEdit.directEditError` signal signature from `(str, list)` to `([str, list], [str, list, str])`
- Added `Feature.synchronization`
- Added `restart_needed` keyword argument to `FeatureModel.__init__()`
- Added `FeatureModel.restart_needed` property.
- Added `Manager.get_engine_db()`
- Added `Manager.remove_engine_dbs()`
- Added `setter` keyword argument to `Manager.set_feature_state()`
- Added `QMLDriveApi.continue_oauth2_flow()`
- Added `use_legacy_auth` argument to `QMLDriveApi.web_authentication()`, its signal signature was modified from `(str, str)` to `(str, str, bool)`
- Removed all arguments from `Remote.request_token()`
- Added auth/
- Removed `lazy` keyword argument from utils.py::`decrypt()`
- Removed `lazy` keyword argument from utils.py::`encrypt()`
